import{_ as A,u as O,r as m,o as P,m as $,a as G,d as H,b as C,c as J,e as V,f as w,g as o,h as K,w as l,i as _,t as y,j as c,F as z,k as Q,l as W,p as X,E as Z,n as ee,q as oe,s as te,v as ae,x as le,y as ne,z as se,A as ie,B as re,C as de,D as pe,G as ue}from"./index-0x5QSI-3.js";const me={class:"flex-box"},_e={style:{"margin-left":"10px"}},ce={class:"pagination-info"},fe={class:"dialog-footer"},ge={__name:"index",setup(be){const h=O(),r=m({pageNum:1,pageSize:10}),p=m({list:[],total:0});P(()=>{u(),$().then(({data:a})=>{f.value=a.data})});const u=()=>{G(r).then(({data:a})=>{const{list:e,total:i}=a.data;e.forEach(n=>{n.create_time=H(n.create_time).format("YYYY-MM-DD")}),p.list=e,p.total=i})},f=C([]),N=a=>{r.pageSize=a,u()},S=a=>{r.pageNum=a,u()},d=C(!1),B=()=>{d.value=!1},D=m({name:[{required:!0,message:"请输入昵称",trigger:"blur"}],permissions_id:[{required:!0,message:"请选择菜单权限",trigger:"blur"}]}),x=C(),s=m({name:"",permissions_id:""}),U=async a=>{a&&await a.validate((e,i)=>{if(e){const{name:n,permissions_id:g}=s;W({name:n,permissions_id:g}).then(({data:b})=>{b.code===1e4&&(d.value=!1,u())})}else console.log("error submit!",i)})},F=a=>{const e=f.value.find(i=>i.id===a);return e?e.name:"超级管理员"},I=a=>{d.value=!0,Object.assign(s,{mobile:a.mobile,name:a.name,permissions_id:a.permissions_id})};return(a,e)=>{const i=X,n=Z,g=ee,b=J("Clock"),T=oe,E=te,Y=ae,j=le,k=ne,v=se,q=ue,L=ie,M=re,R=de;return V(),w(z,null,[o(i,{route:K(h)},null,8,["route"]),o(Y,{data:p.list,style:{width:"100%"}},{default:l(()=>[o(n,{prop:"id",label:"id"}),o(n,{prop:"name",label:"昵称"}),o(n,{prop:"permissions_id",label:"所属组别"},{default:l(t=>[_(y(F(t.row.permissions_id)),1)]),_:1}),o(n,{prop:"mobile",label:"手机号"}),o(n,{prop:"active",label:"状态"},{default:l(t=>[o(g,{type:"scope.row.active?'success':'danger'"},{default:l(()=>[_(y(t.row.active?"正常":"失效"),1)]),_:2},1024)]),_:1}),o(n,{label:"创建时间"},{default:l(t=>[c("div",me,[o(T,null,{default:l(()=>[o(b)]),_:1}),c("span",_e,y(t.row.create_time),1)])]),_:1}),o(n,{label:"操作"},{default:l(t=>[o(E,{type:"primary",onClick:ve=>I(t.row)},{default:l(()=>e[6]||(e[6]=[_("编辑")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),c("div",ce,[o(j,{"current-page":r.pageNum,"onUpdate:currentPage":e[0]||(e[0]=t=>r.pageNum=t),"page-size":r.pageSize,background:!1,size:"small",layout:"total, prev, pager, next",total:p.total,onSizeChange:N,onCurrentChange:S},null,8,["current-page","page-size","total"])]),o(R,{modelValue:d.value,"onUpdate:modelValue":e[5]||(e[5]=t=>d.value=t),"before-close":B,title:"添加权限",width:"500"},{footer:l(()=>[c("div",fe,[o(E,{type:"primary",onClick:e[4]||(e[4]=t=>U(x.value))},{default:l(()=>e[7]||(e[7]=[_("确认")])),_:1})])]),default:l(()=>[o(M,{ref_key:"formRef",ref:x,"label-width":"100px","label-position":"left",model:s,rules:D},{default:l(()=>[o(v,{label:"手机号",prop:"mobile"},{default:l(()=>[o(k,{modelValue:s.mobile,"onUpdate:modelValue":e[1]||(e[1]=t=>s.mobile=t),disabled:""},null,8,["modelValue"])]),_:1}),o(v,{label:"昵称",prop:"name"},{default:l(()=>[o(k,{modelValue:s.name,"onUpdate:modelValue":e[2]||(e[2]=t=>s.name=t)},null,8,["modelValue"])]),_:1}),o(v,{label:"菜单权限",prop:"permissions_id"},{default:l(()=>[o(L,{modelValue:s.permissions_id,"onUpdate:modelValue":e[3]||(e[3]=t=>s.permissions_id=t),placeholder:"请选择菜单权限",style:{width:"240px"}},{default:l(()=>[(V(!0),w(z,null,Q(f.value,t=>(V(),pe(q,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}},Ve=A(ge,[["__scopeId","data-v-787bdf3e"]]);export{Ve as default};
